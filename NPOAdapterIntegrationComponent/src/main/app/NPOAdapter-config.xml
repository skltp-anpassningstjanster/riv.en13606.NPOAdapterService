<?xml version="1.0" encoding="utf-8"?>
<mule xmlns="http://www.mulesoft.org/schema/mule/core" 
	xmlns:spring="http://www.springframework.org/schema/beans" 
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans    http://www.springframework.org/schema/beans/spring-beans-current.xsd   
						http://www.mulesoft.org/schema/mule/core       http://www.mulesoft.org/schema/mule/core/current/mule.xsd">

    <spring:beans>
	    <!-- Connectors and endpoints that that are specific for different config-files (local unit-test, integration-test or production environments) -->
    	<!-- TODO: Add import of connector specific configuration files here as required -->
		<!-- <spring:import resource="classpath:NPOAdapter-common.xml"/> -->
        
     	<!-- Import services -->
        <spring:import resource="classpath:services/*-service.xml"/>

        <spring:bean id="router" class="se.skl.skltpservices.npoadapter.router.Router">
            <spring:property name="takCacheFilename" value="${FILE_LOCAL_TAK_CACHE}" />
            <spring:property name="takWSDL" value="${ENDPOINT_TAK_WSDL}" />
        </spring:bean>

        <spring:bean id="route-processor" class="se.skl.skltpservices.npoadapter.mule.OutboundRouter">
            <spring:property name="responseTimeout" value="${SERVICE_TIMEOUT_MS}" />
        </spring:bean>

        <spring:bean id="pre-processor" class="se.skl.skltpservices.npoadapter.mule.PreProcessor">
            <spring:property name="router" ref="router" />
        </spring:bean>

    </spring:beans>

    <custom-transformer class="se.skl.skltpservices.npoadapter.mule.UpdateIndexTransformer" name="update-index-transformer">
        <spring:property name="eiLogicalAddress" value="${LOGICAL_ADDRESS_EI}" />
    </custom-transformer>

    <custom-transformer class="se.skl.skltpservices.npoadapter.mule.SendIndexTransformer" name="send-index-transformer">
        <spring:property name="router" ref="router" />
    </custom-transformer>

</mule>